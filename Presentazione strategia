<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gestione Strategica e Operativa eCommerce ‚Äî Presentazione</title>

  <!-- Google Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Varela+Round&display=swap" rel="stylesheet">

  <!-- PDF libs (solo web) -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

  <style>
    /* ===== PRINT / VIVLIOSTYLE =====
       297mm x 167mm ~ 16:9 (wide), stile slide
    */
    @page { size: 297mm 167mm; margin: 0; }
    * { box-sizing: border-box; -webkit-print-color-adjust: exact; print-color-adjust: exact; }

    :root{
      --blu:#0e2166;
      --viola:#8923ad;
      --azzurro:#19c6ff;

      --grigio:#4b5563;
      --muted:#6b7280;

      --arancio:#f97316;
      --arancio-bd:#fed7aa;
      --arancio-bg:#fff7ed;
      --arancio-txt:#9a3412;

      --verde:#15803d;
      --verde-bg:#ecfdf5;
      --verde-bd:#bbf7d0;

      --rosso:#ef4444;
      --rosso-bd:#fecaca;
      --rosso-bg:#fef2f2;
      --rosso-txt:#991b1b;

      --card-bd:#e2e5f3;

      /* Web viewer scaling + pan */
      --web-scale: 1;
      --pan-x: 0px;
      --pan-y: 0px;
    }

    body{
      margin:0;
      font-family:"Varela Round", Arial, Helvetica, sans-serif;
      color:#101827;
      background:#0b1220;
    }

    /* Ogni slide = 1 pagina (print) / 1 frame (web) */
    .slide{
      width: 297mm;
      height: 167mm;
      position: relative;
      overflow: hidden;
      page-break-after: always;
      transform-origin: center center;
    }
    .slide:last-child{ page-break-after: auto; }

    /* Sfondo ‚Äúpowerpoint style‚Äù pieno */
    .bg-soft{
      background:
        radial-gradient(circle at 0% 0%, rgba(25,198,255,0.22) 0, transparent 55%),
        radial-gradient(circle at 100% 0%, rgba(137,35,173,0.20) 0, transparent 55%),
        radial-gradient(circle at 30% 100%, rgba(249,115,22,0.12) 0, transparent 60%),
        linear-gradient(180deg, #fbfcff 0%, #ffffff 55%, #f6f7ff 100%);
    }

    /* Safe-area come Canva */
    .pad{
      position:absolute;
      inset: 12mm;
      display:flex;
      flex-direction:column;
      gap: 8mm;
    }

    /* ===== Header pill + logo ===== */
    .top-bar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
    }

    .pill-row{ display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      border-radius:999px;
      border:1px solid #dce8ff;
      padding:8px 13px;
      font-size: 13px;
      font-weight: 900;
      color:var(--blu);
      background:#f5f7ff;
      white-space:nowrap;
      box-shadow: 0 10px 24px rgba(15,23,42,0.06);
    }
    .pill-dot{
      width:10px; height:10px; border-radius:999px;
      background:linear-gradient(135deg,var(--viola),var(--azzurro));
    }
    .pill-red{
      display:inline-flex; align-items:center; gap:8px;
      border-radius:999px;
      border:1px solid var(--rosso-bd);
      padding:8px 13px;
      font-size: 13px;
      font-weight: 900;
      color: var(--rosso-txt);
      background: var(--rosso-bg);
      white-space:nowrap;
      box-shadow: 0 10px 24px rgba(15,23,42,0.06);
    }
    .pill-red-dot{
      width:10px; height:10px; border-radius:999px;
      background: linear-gradient(135deg,#f87171,var(--rosso));
      box-shadow: 0 4px 10px rgba(239,68,68,0.18);
    }
    .logo{
      height: 34px;
      display:block;
      filter: drop-shadow(0 10px 18px rgba(15,23,42,0.10));
    }
    .logo-lg{
      height: 52px;
      display:block;
      filter: drop-shadow(0 12px 24px rgba(15,23,42,0.12));
    }

    /* ===== Slide 1 layout ===== */
    .grid{
      display:grid;
      grid-template-columns: 1.15fr 0.85fr;
      gap: 12mm;
      align-items: stretch;
      min-height: 0;
      flex:1;
    }

    /* Trust chips */
    .trust-line{
      display:flex; gap:8px; flex-wrap:wrap; align-items:center;
      font-size: 13px;
      margin-top: 2mm;
    }
    .trust-chip{
      display:inline-flex; align-items:center; gap:6px;
      padding:7px 11px;
      border-radius:999px;
      border:1px solid var(--verde-bd);
      background:var(--verde-bg);
      color:var(--verde);
      font-weight:900;
      white-space:nowrap;
    }
    .trust-dot{
      width:8px;height:8px;border-radius:999px;
      background:linear-gradient(135deg,#34d399,var(--verde));
      box-shadow: 0 4px 10px rgba(21,128,61,0.14);
    }

    .hero-title{
      margin: 6mm 0 0 0;
      font-size: 44px;
      line-height: 1.05;
      color:var(--blu);
      letter-spacing:-0.7px;
    }
    .hero-title span{ color:var(--viola); }

    .hero-sub{
      margin-top: 4mm;
      color: var(--muted);
      font-size: 16px;
      line-height: 1.35;
      max-width: 92%;
    }

    /* Value cards */
    .value-grid{
      margin-top: 6mm;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .value-item{
      border-radius:16px;
      border:1px solid #e2e8f0;
      background: rgba(255,255,255,0.82);
      padding:12px 14px;
      display:flex;
      gap:10px;
      align-items:flex-start;
      box-shadow: 0 18px 50px rgba(15,23,42,0.06);
      backdrop-filter: blur(6px);
      min-height: 86px;
    }
    .value-icon{
      width:28px; height:28px;
      border-radius:11px;
      background:linear-gradient(135deg,#eef2ff,#f5f7ff);
      border:1px solid #e0e7ff;
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:900;
      color:var(--blu);
      flex:0 0 28px;
      line-height:1;
      margin-top:1px;
    }
    .value-title{
      font-size: 15px;
      font-weight: 900;
      color:#111827;
      line-height:1.12;
      margin-bottom: 4px;
    }
    .value-desc{
      font-size: 13px;
      color: var(--muted);
      line-height:1.25;
    }

    .mega-badge{
      margin-top: 6mm;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding: 11px 16px;
      border-radius:999px;
      border:1px solid var(--arancio-bd);
      background: linear-gradient(135deg, rgba(255,247,237,0.95), rgba(255,255,255,0.9));
      box-shadow: 0 18px 50px rgba(249,115,22,0.10);
      backdrop-filter: blur(6px);
    }
    .mega-main{
      font-size: 16px;
      font-weight: 900;
      color:var(--arancio-txt);
      white-space:nowrap;
    }
    .mega-highlight{ color: var(--arancio); }
    .mega-sub{
      font-size: 13px;
      font-weight: 900;
      white-space:nowrap;
      padding:8px 11px;
      border-radius:999px;
      border:1px solid rgba(14,33,102,0.18);
      background: rgba(239,246,255,0.92);
      color:var(--blu);
    }

    /* Side panel */
    .side{
      display:flex;
      flex-direction:column;
      gap: 10px;
      min-height: 0;
    }
    .side-title{
      font-size: 18px;
      font-weight: 900;
      color: var(--blu);
      letter-spacing:-0.2px;
      margin:0;
    }
    .side-sub{ margin-top:3px; font-size: 13px; color: var(--muted); }

    .kpi{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-top: 4px;
    }
    .kpi-box{
      border-radius:16px;
      border:1px solid #e5e7eb;
      background: rgba(255,255,255,0.85);
      padding:12px 14px;
      box-shadow: 0 18px 50px rgba(15,23,42,0.06);
      backdrop-filter: blur(6px);
    }
    .kpi-label{ font-size: 12px; color: var(--muted); font-weight: 900; }
    .kpi-value{ margin-top:7px; font-size: 24px; font-weight: 900; color:#111827; }
    .kpi-chip{
      margin-top:10px;
      display:inline-flex; align-items:center; gap:8px;
      padding:7px 11px;
      border-radius:999px;
      border:1px solid var(--verde-bd);
      background:var(--verde-bg);
      color:var(--verde);
      font-weight:900;
      font-size: 12px;
      white-space:nowrap;
    }
    .kpi-dot{
      width:10px;height:10px;border-radius:999px;
      background:linear-gradient(135deg,#34d399,var(--verde));
    }

    .cta{
      margin-top:auto;
      border-radius:18px;
      border:1px solid var(--arancio-bd);
      background: linear-gradient(135deg, rgba(255,247,237,0.95), rgba(255,255,255,0.9));
      padding: 13px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      box-shadow: 0 18px 50px rgba(249,115,22,0.10);
      backdrop-filter: blur(6px);
    }
    .cta-title{
      font-size: 15px;
      font-weight: 900;
      color: var(--arancio-txt);
      line-height: 1.15;
    }
    .cta-title span{ color: var(--arancio); }
    .cta-sub{
      margin-top: 4mm;
      font-size: 12.8px;
      color: var(--arancio-txt);
      opacity: 0.95;
      line-height: 1.25;
    }
    .cta-btn{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:11px 13px;
      border-radius:999px;
      border:1px solid var(--arancio-bd);
      background:linear-gradient(135deg, #ffffff, var(--arancio-bg));
      color:var(--arancio-txt);
      font-weight:900;
      font-size:13px;
      white-space:nowrap;
      text-decoration:none;
    }
    .cta-btn-dot{
      width:10px;height:10px;border-radius:999px;
      background:linear-gradient(135deg,#f59e0b,var(--arancio));
    }

    /* ===== Slide 2 styles ===== */
    .grid-2{
      display:grid;
      grid-template-columns: 0.9fr 1.1fr;
      gap: 10mm;
      flex:1;
      min-height: 0;
      align-items: stretch;
    }

    table{ border-collapse:collapse; width:100%; }
    .cs-table{
      width:100%;
      border-radius:18px;
      overflow:hidden;
      border:1px solid #e5e7eb;
      background: rgba(255,255,255,0.88);
      box-shadow: 0 18px 55px rgba(15,23,42,0.08);
      backdrop-filter: blur(6px);
    }
    .cs-table th, .cs-table td{
      border:1px solid #e5e7eb;
      padding:12px 12px;
      font-size: 13px;
      vertical-align: middle;
    }
    .cs-table th{
      background:#f5f7ff;
      color:#111827;
      text-align:left;
    }
    .cs-col-plan{ text-align:center; }
    .cs-annual{ background:linear-gradient(135deg,#e0edff,#f5f7ff); }
    .cs-triennial{ background:linear-gradient(135deg,#f4e8ff,#fdf2ff); }
    .cs-plan-title{ font-size: 14px; font-weight:900; line-height:1.1; }
    .cs-badge{ display:block; font-size:12.5px; color:var(--muted); margin-top:4px; font-weight:800; }
    .cs-name{ font-weight:900; font-size: 13.5px; margin-bottom: 3px; }
    .cs-desc{ font-size: 12.5px; color: var(--muted); }
    .cs-price{ font-weight:900; font-size: 14.5px; display:inline-block; }
    .cs-saving{
      margin-top: 7px;
      font-size: 12.5px;
      color: var(--verde);
      font-weight: 900;
      display:inline-flex;
      align-items:center;
      gap:8px;
      justify-content:center;
    }
    .save-pill{
      display:inline-block;
      padding:4px 11px;
      border-radius:999px;
      background:#ecfdf5;
      border:1px solid #bbf7d0;
    }

    .badge-orange{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 13px;
      border-radius:999px;
      border:1px solid var(--arancio-bd);
      background: var(--arancio-bg);
      color: var(--arancio-txt);
      font-weight:900;
      font-size: 13px;
      white-space:nowrap;
      box-shadow: 0 10px 24px rgba(15,23,42,0.06);
    }
    .badge-dot{
      width:10px;height:10px;border-radius:999px;
      background: linear-gradient(135deg,#f59e0b,var(--arancio));
      box-shadow: 0 4px 10px rgba(249,115,22,0.16);
    }

    .conditions{
      border-radius:18px;
      border:1px dashed #cbd5f5;
      background: rgba(248,250,252,0.92);
      padding: 14px 16px;
      font-size: 12.8px;
      color: var(--grigio);
      line-height: 1.35;
      box-shadow: 0 18px 55px rgba(15,23,42,0.06);
      backdrop-filter: blur(6px);
    }

    /* ===== New layouts ===== */
    .cover-grid{
      display:grid;
      grid-template-columns: 1.1fr 0.9fr;
      gap: 10mm;
      align-items: stretch;
      flex:1;
    }
    .cover-card{
      border-radius:26px;
      border:1px solid #e2e8f0;
      background:
        radial-gradient(circle at 0% 0%, rgba(25,198,255,0.18) 0, transparent 55%),
        radial-gradient(circle at 100% 0%, rgba(137,35,173,0.14) 0, transparent 55%),
        linear-gradient(180deg, rgba(255,255,255,0.95) 0%, rgba(246,247,255,0.98) 100%);
      padding: 18px 20px;
      box-shadow: 0 28px 80px rgba(15,23,42,0.10);
      display:flex;
      flex-direction:column;
      justify-content:center;
      gap: 12px;
    }
    .cover-title{
      margin:0;
      font-size: 44px;
      line-height: 1.05;
      color: var(--blu);
      letter-spacing:-0.6px;
    }
    .cover-sub{
      margin:0;
      font-size: 16px;
      color: var(--muted);
      line-height:1.35;
    }
    .cover-image{
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 20px;
      border: none;
      box-shadow: none;
    }

    .benefit-grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 3mm;
    }
    .benefit-card{
      border-radius:14px;
      border:1px solid #e2e8f0;
      background: rgba(255,255,255,0.9);
      padding:10px 12px;
      box-shadow: 0 18px 50px rgba(15,23,42,0.06);
    }
    .benefit-card h3{
      margin:0 0 4px 0;
      font-size: 14px;
      color:#111827;
      font-weight: 900;
    }
    .benefit-card p{
      margin:0;
      font-size: 12.5px;
      color: var(--muted);
      line-height:1.3;
    }

    .step-grid{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 6mm;
      margin-top: 3mm;
      flex:1;
    }
    .step-card{
      border-radius:16px;
      border:1px solid #e5e7eb;
      background: rgba(255,255,255,0.9);
      padding:12px 14px;
      box-shadow: 0 18px 55px rgba(15,23,42,0.08);
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .step-num{
      font-size: 12px;
      font-weight:900;
      color: var(--viola);
      letter-spacing: 0.4px;
    }
    .step-title{
      font-size: 14px;
      font-weight:900;
      color:#111827;
      margin:0;
    }
    .step-desc{
      font-size: 12.5px;
      color: var(--muted);
      line-height:1.3;
      margin:0;
    }

    .package-grid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 6mm;
      margin-top: 3mm;
      flex:1;
    }
    .package-card{
      border-radius:18px;
      padding:12px 14px;
      border:1px solid #e5e7eb;
      background: rgba(255,255,255,0.92);
      box-shadow: 0 18px 55px rgba(15,23,42,0.08);
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .package-card.featured{
      border:2px solid rgba(137,35,173,0.25);
      background:
        radial-gradient(circle at 0% 0%, rgba(25,198,255,0.18) 0, transparent 55%),
        radial-gradient(circle at 100% 0%, rgba(137,35,173,0.16) 0, transparent 55%),
        rgba(255,255,255,0.95);
      box-shadow: 0 28px 80px rgba(137,35,173,0.14);
      transform: translateY(-2mm);
    }
    .package-title{
      font-size: 16px;
      font-weight:900;
      color:#111827;
      margin:0;
    }
    .package-price{
      font-size: 18px;
      font-weight:900;
      color: var(--blu);
      margin:0;
    }
    .package-sub{
      font-size: 12px;
      color: var(--muted);
      margin:0;
    }
    .package-list{
      margin:0;
      padding-left: 18px;
      font-size: 12px;
      color: var(--muted);
      line-height:1.35;
    }
    .package-tag{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid #dbeafe;
      background:#eff6ff;
      color: var(--blu);
      font-size:12px;
      font-weight:900;
      white-space:nowrap;
    }

    .logo-grid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-top: 4mm;
    }
    .logo-chip{
      border-radius:16px;
      border:1px solid #e2e8f0;
      background: rgba(255,255,255,0.9);
      padding:12px;
      text-align:center;
      font-weight:900;
      color:#111827;
      font-size: 14px;
      box-shadow: 0 18px 50px rgba(15,23,42,0.06);
    }
    .info-card{
      border-radius:14px;
      border:1px solid #e2e8f0;
      background: rgba(255,255,255,0.9);
      padding:10px 12px;
      box-shadow: 0 18px 50px rgba(15,23,42,0.06);
    }
    .info-card h4{
      margin:0 0 4px 0;
      font-size: 13px;
      font-weight:900;
      color:#111827;
    }
    .info-card p{
      margin:0;
      font-size:12px;
      color:var(--muted);
      line-height:1.3;
    }
    .info-row{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
    }
    .quote-card{
      border-radius:20px;
      border:1px solid #e2e8f0;
      background: rgba(255,255,255,0.92);
      padding:16px 18px;
      box-shadow: 0 18px 55px rgba(15,23,42,0.08);
    }
    .quote-card p{
      margin:0;
      font-size:14px;
      color:#111827;
      line-height:1.4;
    }
    .quote-card .who{
      margin-top:8px;
      font-size:12.5px;
      color:var(--muted);
      font-weight:900;
    }

    /* =======================================================================
       WEB SHELL (solo screen)
       ======================================================================= */
    @media screen{
      body{
        background:
          radial-gradient(circle at 20% -10%, rgba(25,198,255,0.16) 0, transparent 55%),
          radial-gradient(circle at 110% 10%, rgba(137,35,173,0.14) 0, transparent 55%),
          radial-gradient(circle at 50% 120%, rgba(249,115,22,0.10) 0, transparent 60%),
          linear-gradient(180deg, #070b14 0%, #0b1220 55%, #070b14 100%);
        min-height: 100vh;
      }

      .web-shell{
        min-height: 100vh;
        display:flex;
        flex-direction:column;
      }

      .web-topbar{
        position: sticky;
        top: 0;
        z-index: 50;
        backdrop-filter: blur(12px);
        background: rgba(11,18,32,0.55);
        border-bottom: 1px solid rgba(255,255,255,0.08);
      }

      .web-topbar-inner{
        max-width: 1400px;
        margin: 0 auto;
        padding: 14px 16px;
        display:flex;
        align-items:center;
        justify-content:space-between;
        gap: 12px;
      }

      .brand{
        display:flex;
        align-items:center;
        gap: 10px;
        min-width: 220px;
      }
      .brand .mark{
        width: 12px; height: 12px; border-radius: 999px;
        background: linear-gradient(135deg, var(--viola), var(--azzurro));
        box-shadow: 0 12px 30px rgba(25,198,255,0.18);
      }
      .brand .title{
        color:#eaf0ff;
        font-weight:900;
        letter-spacing:-0.2px;
        font-size: 14px;
        line-height: 1.2;
      }
      .brand .sub{ display:none; } /* RIMOSSO: "Viewer web + PDF (stesso file)" */

      .web-actions{
        display:flex;
        align-items:center;
        gap: 10px;
        flex-wrap:wrap;
        justify-content:flex-end;
      }

      .web-btn{
        appearance:none;
        border:1px solid rgba(255,255,255,0.14);
        background: rgba(255,255,255,0.06);
        color:#eaf0ff;
        font-family: inherit;
        font-weight: 900;
        font-size: 12.5px;
        padding: 10px 12px;
        border-radius: 999px;
        cursor:pointer;
        display:inline-flex;
        align-items:center;
        gap:8px;
        transition: transform .12s ease, background .12s ease, border-color .12s ease;
        user-select:none;
      }
      .web-btn:hover{ transform: translateY(-1px); background: rgba(255,255,255,0.10); border-color: rgba(255,255,255,0.22); }
      .web-btn:active{ transform: translateY(0px); }
      .web-btn.primary{
        border-color: rgba(249,115,22,0.35);
        background: linear-gradient(135deg, rgba(249,115,22,0.14), rgba(255,255,255,0.06));
      }
      .web-btn .dot{
        width:8px;height:8px;border-radius:999px;
        background: linear-gradient(135deg, #f59e0b, var(--arancio));
      }
      .web-btn[disabled]{ opacity:.55; cursor:not-allowed; transform:none !important; }

      .kbd{
        font-size: 11px;
        font-weight: 900;
        padding: 2px 6px;
        border-radius: 8px;
        border: 1px solid rgba(255,255,255,0.16);
        background: rgba(255,255,255,0.08);
        color: rgba(234,240,255,0.85);
      }

      .viewer-wrap{
        flex:1;
        display:flex;
        align-items:center;
        justify-content:center;
        padding: 18px 16px 28px;
      }

      .viewer{
        width: min(1400px, 100%);
        border-radius: 20px;
        border: 1px solid rgba(255,255,255,0.10);
        background: rgba(255,255,255,0.04);
        box-shadow:
          0 50px 140px rgba(0,0,0,0.55),
          0 18px 60px rgba(15,23,42,0.30);
        padding: 14px;
        position: relative;
      }

      /* Banner (solo web, NON deve andare in stampa) */
      .web-banner{
        display:flex;
        align-items:center;
        justify-content:center;
        gap:10px;
        margin: 2px 2px 10px;
        padding: 10px 12px;
        border-radius: 16px;
        border: 1px solid rgba(249,115,22,0.22);
        background:
          radial-gradient(circle at 10% 0%, rgba(25,198,255,0.20) 0, transparent 55%),
          radial-gradient(circle at 100% 0%, rgba(137,35,173,0.18) 0, transparent 55%),
          linear-gradient(135deg, rgba(255,255,255,0.08), rgba(255,255,255,0.04));
        color: rgba(234,240,255,0.92);
        box-shadow: 0 24px 70px rgba(0,0,0,0.35);
      }
      .web-banner .chip{
        display:inline-flex;
        align-items:center;
        gap:8px;
        padding: 8px 12px;
        border-radius: 999px;
        border: 1px solid rgba(255,255,255,0.16);
        background: rgba(255,255,255,0.06);
        font-weight: 900;
        font-size: 12.5px;
        letter-spacing: -0.1px;
        white-space: nowrap;
      }
      .web-banner .chip .spark{
        width: 9px; height: 9px; border-radius: 999px;
        background: linear-gradient(135deg, var(--azzurro), var(--arancio));
        box-shadow: 0 10px 26px rgba(25,198,255,0.18);
      }
      .web-banner .big{
        font-weight: 900;
        font-size: 13px;
        letter-spacing: -0.2px;
        white-space: nowrap;
      }

      /* Stage */
      .stage{
        position: relative;
        overflow: hidden;
        border-radius: 16px;
        background: rgba(0,0,0,0.20);
        border: 1px solid rgba(255,255,255,0.10);

        display:flex;
        align-items:center;
        justify-content:center;
        height: min(76vh, 820px);
        touch-action: pan-y; /* consenti scroll verticale pagina */
      }

      /* mostra una slide alla volta in web */
      #deck .slide{ display:none; }
      #deck .slide.is-active{ display:block; }

      /* scala + pan in web */
      #deck .slide{
        transform: translate3d(var(--pan-x), var(--pan-y), 0) scale(var(--web-scale));
        will-change: transform;
      }

      /* progress bar */
      .progress{
        height: 4px;
        width: 100%;
        background: rgba(255,255,255,0.08);
        border-radius: 999px;
        overflow:hidden;
        margin-top: 10px;
      }
      .progress > div{
        height:100%;
        width: 0%;
        background: linear-gradient(90deg, var(--azzurro), var(--viola), var(--arancio));
      }

      .footer-hint{
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 16px 18px;
        color: rgba(234,240,255,0.70);
        font-size: 12px;
        display:flex;
        justify-content:space-between;
        gap: 12px;
        flex-wrap:wrap;
      }

      /* RIMOSSO: link rapido (non lo mostriamo proprio) */
      .footer-hint .quick{ display:none; }

      /* Animazioni (pi√π belle) */
      @keyframes slideIn {
        from { opacity: 0; transform: translate3d(var(--pan-x), calc(var(--pan-y) + 18px), 0) scale(var(--web-scale)); filter: blur(8px); }
        to   { opacity: 1; transform: translate3d(var(--pan-x), var(--pan-y), 0) scale(var(--web-scale)); filter: blur(0px); }
      }
      @keyframes floaty {
        0%,100% { transform: translateY(0px); }
        50% { transform: translateY(-3px); }
      }

      #deck .slide.is-active{
        animation: slideIn 520ms cubic-bezier(.2,.8,.2,1) both;
      }
      /* piccoli micro-movimenti su pill/badge (solo web) */
      #deck .slide.is-active .pill,
      #deck .slide.is-active .badge-orange,
      #deck .slide.is-active .pill-red{
        animation: floaty 4.4s ease-in-out 700ms infinite;
      }
      /* reveal progressivo */
      #deck .slide.is-active .hero-title,
      #deck .slide.is-active .hero-sub,
      #deck .slide.is-active .trust-line,
      #deck .slide.is-active .value-item,
      #deck .slide.is-active .benefit-card,
      #deck .slide.is-active .info-card,
      #deck .slide.is-active .step-card,
      #deck .slide.is-active .package-card,
      #deck .slide.is-active .logo-chip,
      #deck .slide.is-active .quote-card,
      #deck .slide.is-active .cover-card,
      #deck .slide.is-active .kpi-box,
      #deck .slide.is-active .cta,
      #deck .slide.is-active .cs-table,
      #deck .slide.is-active .conditions{
        opacity: 0;
        transform: translateY(10px);
        animation: revealUp 520ms cubic-bezier(.2,.8,.2,1) forwards;
      }
      @keyframes revealUp{
        to { opacity: 1; transform: translateY(0px); }
      }
      #deck .slide.is-active .trust-line{ animation-delay: 120ms; }
      #deck .slide.is-active .hero-title{ animation-delay: 170ms; }
      #deck .slide.is-active .hero-sub{ animation-delay: 220ms; }
      #deck .slide.is-active .value-item:nth-child(1){ animation-delay: 260ms; }
      #deck .slide.is-active .value-item:nth-child(2){ animation-delay: 320ms; }
      #deck .slide.is-active .kpi-box:nth-child(1){ animation-delay: 260ms; }
      #deck .slide.is-active .kpi-box:nth-child(2){ animation-delay: 300ms; }
      #deck .slide.is-active .kpi-box:nth-child(3){ animation-delay: 340ms; }
      #deck .slide.is-active .kpi-box:nth-child(4){ animation-delay: 380ms; }
      #deck .slide.is-active .cta{ animation-delay: 420ms; }
      #deck .slide.is-active .cs-table{ animation-delay: 300ms; }
      #deck .slide.is-active .conditions{ animation-delay: 360ms; }

      @media (prefers-reduced-motion: reduce){
        *{ animation: none !important; transition: none !important; }
      }

      /* Overlay loading PDF */
      .pdf-overlay{
        position:absolute;
        inset: 14px;
        border-radius: 18px;
        background: rgba(0,0,0,0.46);
        border: 1px solid rgba(255,255,255,0.14);
        backdrop-filter: blur(10px);
        display:none;
        align-items:center;
        justify-content:center;
        flex-direction:column;
        gap: 10px;
        z-index: 20;
        color: rgba(234,240,255,0.92);
        text-align:center;
        padding: 18px;
      }
      .pdf-overlay.is-on{ display:flex; }
      .spinner{
        width: 38px; height: 38px;
        border-radius: 999px;
        border: 3px solid rgba(255,255,255,0.16);
        border-top-color: rgba(25,198,255,0.90);
        animation: spin 900ms linear infinite;
      }
      @keyframes spin { to { transform: rotate(360deg); } }

      @media (max-width: 560px){
        .brand{ min-width: 0; }
        .web-actions{ gap: 8px; }
        .web-btn{ padding: 9px 10px; font-size: 12px; }
        .viewer{ padding: 10px; }
        .stage{ height: min(74vh, 640px); }
        .web-banner{ padding: 10px; }
        .web-banner .big{ font-size: 12.5px; }
      }
    }

    /* ===== PRINT FIX (Vivliostyle): non nascondere le slide! ===== */
    @media print{
      /* lascia visibile ci√≤ che contiene le slide */
      .web-shell{ display:block !important; }

      /* nascondi solo UI */
      .web-topbar, .footer-hint, .progress, .web-banner, .pdf-overlay{ display:none !important; }

      /* rimuovi cornici/padding in stampa */
      .viewer-wrap{ padding:0 !important; }
      .viewer{ padding:0 !important; border:none !important; background:transparent !important; box-shadow:none !important; }
      .stage{ border:none !important; background:transparent !important; display:block !important; height:auto !important; }

      /* tutte le slide visibili, no scale */
      #deck .slide{ display:block !important; transform:none !important; }

      body{ background:#ffffff !important; }
      a{ color:inherit !important; text-decoration:none !important; }
    }
  </style>
</head>

<body>

  <div class="web-shell">
    <div class="web-topbar">
      <div class="web-topbar-inner">
        <div class="brand">
          <span class="mark"></span>
          <div>
            <div class="title">Gestione Strategica e Operativa eCommerce</div>
          </div>
        </div>

        <div class="web-actions">
          <button class="web-btn" id="prevBtn" type="button" title="Slide precedente (‚Üê)">‚Üê Precedente</button>
          <button class="web-btn" id="nextBtn" type="button" title="Slide successiva (‚Üí)">Successiva ‚Üí</button>

          <button class="web-btn" id="zoomOutBtn" type="button" title="Zoom -">‚àí</button>
          <button class="web-btn" id="zoomInBtn" type="button" title="Zoom +">+</button>

          <!-- FULLSCREEN RIMOSSO -->

          <button class="web-btn primary" id="pdfBtn" type="button" title="Genera e scarica il PDF">
            <span class="dot"></span> Salva in PDF
          </button>

          <span class="kbd">‚Üê ‚Üí</span>
        </div>
      </div>
    </div>

    <div class="viewer-wrap">
      <div class="viewer" id="viewer">
        <!-- Banner visibile SOLO web -->
        <div class="web-banner" aria-hidden="true">
          <span class="chip"><span class="spark"></span> Nuovo servizio</span>
          <span class="big">Pi√π risultati, meno complessit√† operativa</span>
        </div>

        <div class="stage" id="stage">
          <main id="deck">

            <!-- ===================== SLIDE 0 ===================== -->
            <div class="slide bg-soft">
              <div class="pad">

                <div class="top-bar">
                  <div class="pill-row">
                    <img class="logo-lg" src="http://img.mailinblue.com/9212108/images/68cc492abd5f0_1758218538.png" alt="Logo Migliorshop">
                  </div>
                </div>

                <div class="cover-grid">
                  <div class="cover-card">
                    <h1 class="cover-title">Il Miglior partner per la tua <span>farmacia online</span></h1>
                    <p class="cover-sub">Brochure strategia per l‚ÄôeCommerce farmacia</p>
                    <div class="trust-line">
                      <span class="trust-chip"><span class="trust-dot"></span>Strategia + Operativit√†</span>
                      <span class="trust-chip"><span class="trust-dot"></span>Focus performance</span>
                      <span class="trust-chip"><span class="trust-dot"></span>Metodo scalabile</span>
                    </div>
                    <div class="mega-badge" style="margin-top:4mm;">
                      <div class="mega-main">Risultati chiari ¬∑ <span class="mega-highlight">Zero complessit√†</span></div>
                      <div class="mega-sub">Tu guidi la visione, noi eseguiamo</div>
                    </div>
                  </div>
                  <img class="cover-image" src="https://img.mailinblue.com/143672/images/content_library/original/67bc8109711fdda28670fa53.png" alt="Professionista farmacia online">
                </div>

              </div>
            </div>

            <!-- ===================== SLIDE 1 ===================== -->
            <div class="slide bg-soft">
              <div class="pad">

                <div class="top-bar">
                  <div class="pill-row">
                    <div class="pill"><span class="pill-dot"></span>Gestione strategica e operativa eCommerce</div>
                    <div class="pill-red"><span class="pill-red-dot"></span>Servizio operativo per eCommerce B2B</div>
                  </div>
                  <img class="logo" src="http://img.mailinblue.com/9212108/images/68cc492abd5f0_1758218538.png" alt="Logo Migliorshop">
                </div>

                <div class="grid">
                  <!-- LEFT -->
                  <div>
                    <div class="trust-line">
                      <span class="trust-chip"><span class="trust-dot"></span>Tempo risparmiato</span>
                      <span class="trust-chip"><span class="trust-dot"></span>Performance misurabili</span>
                      <span class="trust-chip"><span class="trust-dot"></span>Gestione semplificata</span>
                      <span class="trust-chip"><span class="trust-dot"></span>Operativit√† concreta</span>
                    </div>

                    <h1 class="hero-title">Gestiamo le strategie e le operazioni del tuo <span>eCommerce</span></h1>

                    <p class="hero-sub">
                      Pi√π vendite. Pi√π margine. Meno tempo perso.
                    </p>

                    <div class="value-grid">
                      <div class="value-item">
                        <div class="value-icon">‚è±</div>
                        <div>
                          <div class="value-title">Noi eseguiamo</div>
                          <div class="value-desc">Applichiamo le strategie al posto tuo, mese dopo mese.</div>
                        </div>
                      </div>
                      <div class="value-item">
                        <div class="value-icon">üìà</div>
                        <div>
                          <div class="value-title">Performance in crescita</div>
                          <div class="value-desc">Volumi, conversioni e margini sotto controllo.</div>
                        </div>
                      </div>
                    </div>

                    <div class="benefit-grid" style="margin-top:5mm;">
                      <div class="info-card">
                        <h4>Obiettivi condivisi</h4>
                        <p>Definiamo KPI, priorit√† e mix canali per una crescita sostenibile.</p>
                      </div>
                      <div class="info-card">
                        <h4>Operativit√† continua</h4>
                        <p>Gestione quotidiana delle attivit√† e aggiornamenti costanti.</p>
                      </div>
                      <div class="info-card">
                        <h4>Controllo manageriale</h4>
                        <p>Report sintetici, insight pratici e azioni correttive rapide.</p>
                      </div>
                      <div class="info-card">
                        <h4>Focus su margini</h4>
                        <p>Regole per proteggere redditivit√† e stock strategico.</p>
                      </div>
                    </div>

                    <div class="mega-badge">
                      <div class="mega-main">Operativit√† completa ¬∑ <span class="mega-highlight">Senza complessit√†</span></div>
                      <div class="mega-sub">Tu defini gli obiettivi, noi li mettiamo a terra</div>
                    </div>
                  </div>

                  <!-- RIGHT -->
                  <div class="side">
                    <div>
                      <h2 class="side-title">Risultati attesi</h2>
                      <div class="side-sub">Servizio continuo, operativo e misurabile.</div>
                    </div>

                    <div class="kpi">
                      <div class="kpi-box">
                        <div class="kpi-label">Tempo risparmiato</div>
                        <div class="kpi-value">30%+</div>
                        <div class="kpi-chip"><span class="kpi-dot"></span>Operativit√† delegata</div>
                      </div>
                      <div class="kpi-box">
                        <div class="kpi-label">Conversioni</div>
                        <div class="kpi-value">+15%</div>
                        <div class="kpi-chip"><span class="kpi-dot"></span>Azioni mirate</div>
                      </div>
                      <div class="kpi-box">
                        <div class="kpi-label">Margine medio</div>
                        <div class="kpi-value">+8%</div>
                        <div class="kpi-chip"><span class="kpi-dot"></span>Regole di protezione</div>
                      </div>
                      <div class="kpi-box">
                        <div class="kpi-label">Controllo</div>
                        <div class="kpi-value">Sempre</div>
                        <div class="kpi-chip"><span class="kpi-dot"></span>Report e dashboard</div>
                      </div>
                    </div>

                    <div class="conditions" style="margin-top:4mm;">
                      <strong style="color:var(--blu);">In sintesi</strong><br>
                      Un team operativo dedicato che gestisce attivit√† strategiche e operative per liberare risorse interne e migliorare le performance.
                    </div>

                    <div class="cta">
                      <div>
                        <div class="cta-title">Meno gestione. <span>Pi√π risultati</span></div>
                        <div class="cta-sub">Parliamone e costruiamo la strategia giusta.</div>
                      </div>
                      <a class="cta-btn" href="https://calendar.app.google/uFHDD9vTSKsrS3dp7" target="_blank" rel="noopener noreferrer">
                        <span class="cta-btn-dot"></span>Prenota call
                      </a>
                    </div>
                  </div>
                </div>

              </div>
            </div>

            <!-- ===================== SLIDE 2 ===================== -->
            <div class="slide bg-soft">
              <div class="pad">

                <div class="top-bar">
                  <div class="pill-row">
                    <div class="pill"><span class="pill-dot"></span>Promessa e benefici</div>
                    <div class="badge-orange"><span class="badge-dot"></span>Risultati concreti e misurabili</div>
                  </div>
                  <img class="logo" src="http://img.mailinblue.com/9212108/images/68cc492abd5f0_1758218538.png" alt="Logo Migliorshop">
                </div>

                <div class="grid-2">
                  <!-- LEFT -->
                  <div style="display:flex; flex-direction:column; gap:10px;">
                    <div>
                      <div class="trust-line">
                        <span class="trust-chip"><span class="trust-dot"></span>Operativit√† concreta</span>
                        <span class="trust-chip"><span class="trust-dot"></span>Decisioni rapide</span>
                        <span class="trust-chip"><span class="trust-dot"></span>Controllo costante</span>
                      </div>

                      <h1 class="hero-title" style="font-size:40px;">Perch√© questo servizio <span>funziona</span></h1>
                      <p class="hero-sub" style="font-size:15px;">
                        Non facciamo solo consulenza: applichiamo direttamente le strategie e ti liberiamo dall‚Äôoperativit√†.
                      </p>
                    </div>

                    <div class="benefit-grid">
                      <div class="info-card">
                        <h4>Riduzione complessit√†</h4>
                        <p>Processi chiari, ruoli definiti e priorit√† settimanali.</p>
                      </div>
                      <div class="info-card">
                        <h4>Allineamento continuo</h4>
                        <p>Call mensili e roadmap condivisa per restare focalizzati.</p>
                      </div>
                      <div class="info-card">
                        <h4>Efficienza operativa</h4>
                        <p>Attivit√† eseguite con tempi rapidi e monitoraggio costante.</p>
                      </div>
                      <div class="info-card">
                        <h4>Risultati misurabili</h4>
                        <p>Dashboard con KPI e indicatori di miglioramento chiari.</p>
                      </div>
                    </div>

                    <div class="cta">
                      <div>
                        <div class="cta-title">Pronto a <span>delegare</span>?</div>
                        <div class="cta-sub">Sblocca il tempo del tuo team e focalizzati sul core business.</div>
                      </div>
                      <a class="cta-btn" href="https://calendar.app.google/uFHDD9vTSKsrS3dp7" target="_blank" rel="noopener noreferrer">
                        <span class="cta-btn-dot"></span>Prenota call
                      </a>
                    </div>
                  </div>

                  <!-- RIGHT -->
                  <div>
                    <div class="benefit-grid">
                      <div class="benefit-card">
                        <h3>Risparmi tempo</h3>
                        <p>Applichiamo noi le strategie operative al posto tuo.</p>
                      </div>
                      <div class="benefit-card">
                        <h3>Aumenti le performance</h3>
                        <p>Pi√π volumi, pi√π conversioni, margini protetti.</p>
                      </div>
                      <div class="benefit-card">
                        <h3>Decisioni guidate dai dati</h3>
                        <p>Analisi continue su catalogo, budget e campagne.</p>
                      </div>
                      <div class="benefit-card">
                        <h3>Meno complessit√†</h3>
                        <p>Regole automatiche, controllo costante, meno errori.</p>
                      </div>
                    </div>

                    <div class="conditions" style="margin-top:4mm;">
                      <strong style="color:var(--blu);">Approccio operativo</strong><br>
                      Ogni mese interveniamo su catalogo, pricing e campagne in base ai dati. Niente slide teoriche: solo azioni concrete.
                    </div>
                  </div>

                </div>

              </div>
            </div>

            <!-- ===================== SLIDE 3 ===================== -->
            <div class="slide bg-soft">
              <div class="pad">

                <div class="top-bar">
                  <div class="pill-row">
                    <div class="pill"><span class="pill-dot"></span>Come funziona</div>
                    <div class="badge-orange"><span class="badge-dot"></span>Processo semplice in 4 step</div>
                  </div>
                  <img class="logo" src="http://img.mailinblue.com/9212108/images/68cc492abd5f0_1758218538.png" alt="Logo Migliorshop">
                </div>

                <div style="display:flex; flex-direction:column; gap:6mm; flex:1; min-height:0;">

                  <div>
                    <h1 class="hero-title" style="font-size:42px; margin:0;">
                      Un flusso chiaro, <span>sempre sotto controllo</span>
                    </h1>
                    <p class="hero-sub" style="font-size:15px; max-width:85%;">
                      Dall‚Äôallineamento iniziale all‚Äôottimizzazione continua, lavoriamo con processi snelli e misurabili.
                    </p>
                  </div>

                  <div class="step-grid">
                    <div class="step-card">
                      <div class="step-num">STEP 01</div>
                      <h3 class="step-title">Allineamento strategico</h3>
                      <p class="step-desc">Definizione obiettivi, margini e priorit√†.</p>
                    </div>
                    <div class="step-card">
                      <div class="step-num">STEP 02</div>
                      <h3 class="step-title">Regole e strumenti</h3>
                      <p class="step-desc">Offerte, filtri, logiche di prezzo.</p>
                    </div>
                    <div class="step-card">
                      <div class="step-num">STEP 03</div>
                      <h3 class="step-title">Operativit√† mensile</h3>
                      <p class="step-desc">Le strategie le applichiamo noi.</p>
                    </div>
                    <div class="step-card">
                      <div class="step-num">STEP 04</div>
                      <h3 class="step-title">Monitoraggio continuo</h3>
                      <p class="step-desc">Performance, budget e catalogo sempre sotto controllo.</p>
                    </div>
                  </div>

                  <div class="kpi" style="grid-template-columns: 1fr 1fr 1fr; margin-top:1mm;">
                    <div class="kpi-box">
                      <div class="kpi-label">Deliverable</div>
                      <div class="kpi-value" style="font-size:20px;">Report mensile</div>
                      <div class="kpi-chip"><span class="kpi-dot"></span>Azioni prioritarie</div>
                    </div>
                    <div class="kpi-box">
                      <div class="kpi-label">Cadenza</div>
                      <div class="kpi-value" style="font-size:20px;">Aggiornamenti</div>
                      <div class="kpi-chip"><span class="kpi-dot"></span>Follow-up continuo</div>
                    </div>
                    <div class="kpi-box">
                      <div class="kpi-label">Responsabilit√†</div>
                      <div class="kpi-value" style="font-size:20px;">Noi eseguiamo</div>
                      <div class="kpi-chip"><span class="kpi-dot"></span>Tu approvi</div>
                    </div>
                  </div>

                </div>

              </div>
            </div>

            <!-- ===================== SLIDE 4 ===================== -->
            <div class="slide bg-soft">
              <div class="pad">

                <div class="top-bar">
                  <div class="pill-row">
                    <div class="pill"><span class="pill-dot"></span>Pacchetti di servizio</div>
                    <div class="badge-orange"><span class="badge-dot"></span>Prezzi chiari e trasparenti</div>
                  </div>
                  <img class="logo" src="http://img.mailinblue.com/9212108/images/68cc492abd5f0_1758218538.png" alt="Logo Migliorshop">
                </div>

                <div style="display:flex; flex-direction:column; gap:5mm; flex:1; min-height:0;">
                  <div>
                    <h1 class="hero-title" style="font-size:40px; margin:0;">Scegli il livello <span>pi√π adatto</span></h1>
                    <p class="hero-sub" style="font-size:15px; max-width:85%;">
                      Tre pacchetti per accompagnare la crescita, con attivit√† operative gi√† incluse.
                    </p>
                  </div>

                  <div class="info-row">
                    <div class="info-card">
                      <h4>Servizio continuativo</h4>
                      <p>Operativit√† mensile, con priorit√† condivise e interventi mirati.</p>
                    </div>
                    <div class="info-card">
                      <h4>Strumenti inclusi</h4>
                      <p>Utilizziamo i tool gi√† presenti per applicare subito le strategie.</p>
                    </div>
                    <div class="info-card">
                      <h4>Focus margini</h4>
                      <p>Regole di protezione e controllo costante del rendimento.</p>
                    </div>
                  </div>

                  <div class="package-grid">
                    <div class="package-card">
                      <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
                        <h3 class="package-title">Standard</h3>
                        <span class="package-tag"><span class="pill-dot"></span>Base</span>
                      </div>
                      <p class="package-price">390‚Ç¨ / mese</p>
                      <p class="package-sub">Per partire con metodo e continuit√†.</p>
                      <ul class="package-list">
                        <li>30 min consulenza strategica / mese</li>
                        <li>30 min strategie operative applicate / mese</li>
                        <li>Strategie di offerta base</li>
                        <li>Regole di protezione del margine</li>
                        <li>Analisi base catalogo e anomalie stock</li>
                      </ul>
                    </div>

                    <div class="package-card featured">
                      <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
                        <h3 class="package-title">Plus</h3>
                        <div class="pill" style="background:#fdf2ff;border-color:#f5d0fe;color:var(--viola); box-shadow:none;">
                          <span class="pill-dot"></span>Pi√π richiesto
                        </div>
                      </div>
                      <p class="package-price">690‚Ç¨ / mese</p>
                      <p class="package-sub">Per crescere con ottimizzazioni avanzate.</p>
                      <ul class="package-list">
                        <li>1 ora consulenza strategica / mese</li>
                        <li>60 min strategie operative applicate / mese</li>
                        <li>Strategie avanzate su offerte e pricing</li>
                        <li>Ottimizzazione budget Trovaprezzi</li>
                        <li>Analisi trend e scrematura prodotti ad alte/basse performance</li>
                      </ul>
                    </div>

                    <div class="package-card" style="border-color: rgba(249,115,22,0.28);">
                      <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
                        <h3 class="package-title">Premium</h3>
                        <span class="badge-orange" style="box-shadow:none;">
                          <span class="badge-dot"></span>Full control
                        </span>
                      </div>
                      <p class="package-price">890‚Ç¨ / mese</p>
                      <p class="package-sub">Per chi vuole massime performance e controllo.</p>
                      <ul class="package-list">
                        <li>2 ore consulenza strategica / mese</li>
                        <li>90 min strategie operative applicate / mese</li>
                        <li>Analisi completa del catalogo e competitivit√†</li>
                        <li>Ottimizzazione Google Ads</li>
                        <li>Controllo avanzato di performance, budget e anomalie</li>
                      </ul>
                    </div>
                  </div>

                  <div class="conditions">
                    <strong style="color:var(--blu);">Nota</strong><br>
                    Le strategie devono rientrare negli strumenti disponibili. Non sono incluse personalizzazioni o programmi su misura.
                    Gli strumenti restano ad uso esclusivo del fornitore. Tutti i prezzi sono IVA esclusa.
                  </div>
                </div>
              </div>
            </div>

            <!-- ===================== SLIDE 5 ===================== -->
            <div class="slide bg-soft">
              <div class="pad">

                <div class="top-bar">
                  <div class="pill-row">
                    <div class="pill"><span class="pill-dot"></span>Autorevolezza</div>
                    <div class="badge-orange"><span class="badge-dot"></span>Social proof</div>
                  </div>
                  <img class="logo" src="http://img.mailinblue.com/9212108/images/68cc492abd5f0_1758218538.png" alt="Logo Migliorshop">
                </div>

                <div class="grid">
                  <div>
                    <h1 class="hero-title" style="font-size:40px;">Un approccio scelto da chi gestisce eCommerce <span>complessi</span></h1>
                    <p class="hero-sub" style="font-size:15px; max-width:90%;">
                      Un approccio scelto da chi gestisce eCommerce complessi e orientati alla performance.
                      Trovi in allegato le testate che hanno scritto recensioni.
                    </p>

                    <div class="quote-card" style="margin-top:4mm;">
                      <p>‚ÄúAbbiamo ridotto la complessit√† operativa e aumentato il controllo sulle performance in pochi mesi.‚Äù</p>
                      <div class="who">Direzione eCommerce ¬∑ Cliente B2B</div>
                    </div>

                    <div class="logo-grid">
                      <div class="logo-chip">Testata Partner 1</div>
                      <div class="logo-chip">Testata Partner 2</div>
                      <div class="logo-chip">Testata Partner 3</div>
                      <div class="logo-chip">Media 4</div>
                      <div class="logo-chip">Media 5</div>
                      <div class="logo-chip">Media 6</div>
                    </div>
                  </div>

                  <div class="side" style="justify-content:center;">
                    <div class="info-card">
                      <h4>Perch√© ci scelgono</h4>
                      <p>Esperienza su cataloghi complessi, pricing dinamico e gestione multicanale.</p>
                    </div>
                    <div class="kpi-box">
                      <div class="kpi-label">Focus</div>
                      <div class="kpi-value">B2B eCommerce</div>
                      <div class="kpi-chip"><span class="kpi-dot"></span>Performance-first</div>
                    </div>
                    <div class="kpi-box">
                      <div class="kpi-label">Metodo</div>
                      <div class="kpi-value">Operativo</div>
                      <div class="kpi-chip"><span class="kpi-dot"></span>Strategie applicate</div>
                    </div>
                    <div class="kpi-box">
                      <div class="kpi-label">Risultato</div>
                      <div class="kpi-value">Crescita</div>
                      <div class="kpi-chip"><span class="kpi-dot"></span>Controllo &amp; margini</div>
                    </div>
                  </div>
                </div>

              </div>
            </div>

            <!-- ===================== SLIDE 6 ===================== -->
            <div class="slide bg-soft">
              <div class="pad">

                <div class="top-bar">
                  <div class="pill-row">
                    <div class="pill"><span class="pill-dot"></span>Chiudiamo con la CTA</div>
                    <div class="badge-orange"><span class="badge-dot"></span>Prossimo step</div>
                  </div>
                  <img class="logo" src="http://img.mailinblue.com/9212108/images/68cc492abd5f0_1758218538.png" alt="Logo Migliorshop">
                </div>

                <div class="grid">
                  <div>
                    <h1 class="hero-title" style="font-size:46px;">Meno gestione. <span>Pi√π risultati.</span></h1>
                    <p class="hero-sub" style="font-size:16px; max-width:90%;">
                      Parliamone e costruiamo la strategia giusta per il tuo eCommerce.
                    </p>
                    <div class="mega-badge" style="margin-top:8mm;">
                      <div class="mega-main">Partenza veloce ¬∑ <span class="mega-highlight">Operativit√† inclusa</span></div>
                      <div class="mega-sub">Ti liberiamo tempo, tu guidi la visione</div>
                    </div>

                    <div class="info-row" style="margin-top:6mm;">
                      <div class="info-card">
                        <h4>Call iniziale</h4>
                        <p>Raccogliamo obiettivi, KPI e priorit√† operative.</p>
                      </div>
                      <div class="info-card">
                        <h4>Piano 90 giorni</h4>
                        <p>Roadmap con interventi, timing e responsabilit√†.</p>
                      </div>
                      <div class="info-card">
                        <h4>Kickoff operativo</h4>
                        <p>Avvio attivit√† e monitoraggio settimanale.</p>
                      </div>
                    </div>
                  </div>

                  <div class="side">
                    <div class="cta">
                      <div>
                        <div class="cta-title">Prenota la tua <span>call</span></div>
                        <div class="cta-sub">30 minuti per capire obiettivi e priorit√†.</div>
                      </div>
                      <a class="cta-btn" href="https://calendar.app.google/uFHDD9vTSKsrS3dp7" target="_blank" rel="noopener noreferrer">
                        <span class="cta-btn-dot"></span>Parliamone
                      </a>
                    </div>

                    <div class="kpi-box">
                      <div class="kpi-label">Tempistiche</div>
                      <div class="kpi-value">Onboarding rapido</div>
                      <div class="kpi-chip"><span class="kpi-dot"></span>Setup operativo</div>
                    </div>
                    <div class="kpi-box">
                      <div class="kpi-label">Approccio</div>
                      <div class="kpi-value">Hands-on</div>
                      <div class="kpi-chip"><span class="kpi-dot"></span>No solo consulenza</div>
                    </div>
                  </div>
                </div>

              </div>
            </div>

            <!-- ===================== SLIDE 7 ===================== -->
            <div class="slide bg-soft">
              <div class="pad">

                <div class="top-bar">
                  <div class="pill-row">
                    <img class="logo-lg" src="http://img.mailinblue.com/9212108/images/68cc492abd5f0_1758218538.png" alt="Logo Migliorshop">
                  </div>
                </div>

                <div class="cover-grid">
                  <div class="cover-card">
                    <h1 class="cover-title">Il Miglior partner per la tua <span>farmacia online</span></h1>
                    <p class="cover-sub">Brochure strategia per l‚ÄôeCommerce farmacia</p>
                    <div class="trust-line">
                      <span class="trust-chip"><span class="trust-dot"></span>Strategia chiara</span>
                      <span class="trust-chip"><span class="trust-dot"></span>Operativit√† continua</span>
                      <span class="trust-chip"><span class="trust-dot"></span>Risultati misurabili</span>
                    </div>
                    <div class="mega-badge" style="margin-top:4mm;">
                      <div class="mega-main">Controllo totale ¬∑ <span class="mega-highlight">Pi√π performance</span></div>
                      <div class="mega-sub">Parliamone e attiviamo il percorso</div>
                    </div>
                  </div>
                  <img class="cover-image" src="https://img.mailinblue.com/143672/images/content_library/original/67bc8109711fdda28670fa53.png" alt="Professionista farmacia online">
                </div>

              </div>
            </div>

          </main>
        </div>

        <div class="progress" aria-hidden="true">
          <div id="progressBar"></div>
        </div>

        <!-- Overlay PDF -->
        <div class="pdf-overlay" id="pdfOverlay" aria-live="polite">
          <div class="spinner" aria-hidden="true"></div>
          <div style="font-weight:900;">Sto generando il PDF‚Ä¶</div>
          <div style="opacity:.85; font-size:12.5px;">Non chiudere la pagina (qualche secondo).</div>
        </div>
      </div>
    </div>

    <div class="footer-hint">
      <div>Scorciatoie: <span class="kbd">‚Üê</span> <span class="kbd">‚Üí</span> ¬∑ <span class="kbd">+</span> <span class="kbd">-</span> zoom ¬∑ <span class="kbd">P</span> PDF</div>
      <div class="quick"></div>
    </div>
  </div>

  <script>
    (function(){
      const deck = document.getElementById('deck');
      const slides = Array.from(deck.querySelectorAll('.slide'));
      const progressBar = document.getElementById('progressBar');

      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');
      const zoomInBtn = document.getElementById('zoomInBtn');
      const zoomOutBtn = document.getElementById('zoomOutBtn');
      const pdfBtn = document.getElementById('pdfBtn');
      const stage = document.getElementById('stage');
      const pdfOverlay = document.getElementById('pdfOverlay');

      let index = 0;

      // scale: valore corrente applicato
      let scale = 1;

      // baseFit: scala "fit" calcolata (serve per capire se sto zoomando)
      let baseFit = 1;

      // pan per slide (in px)
      const pans = slides.map(() => ({x:0, y:0}));

      function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

      // --- URL state (?s=1-based)
      function getParamS(){
        const u = new URL(window.location.href);
        const s = parseInt(u.searchParams.get('s') || '1', 10);
        return Number.isFinite(s) ? s : 1;
      }
      function setParamS(oneBased){
        const u = new URL(window.location.href);
        u.searchParams.set('s', String(oneBased));
        window.history.replaceState({}, '', u.toString());
      }

      function setPanVars(){
        const p = pans[index] || {x:0,y:0};
        document.documentElement.style.setProperty('--pan-x', (p.x|0) + 'px');
        document.documentElement.style.setProperty('--pan-y', (p.y|0) + 'px');
      }

      function resetPan(i){
        if(!pans[i]) return;
        pans[i].x = 0;
        pans[i].y = 0;
      }

      function show(i){
        index = clamp(i, 0, slides.length - 1);
        slides.forEach((el, k) => el.classList.toggle('is-active', k === index));

        if(progressBar){
          const pct = slides.length <= 1 ? 100 : ((index) / (slides.length - 1)) * 100;
          progressBar.style.width = pct + '%';
        }

        setParamS(index + 1);

        // reset pan quando cambi slide (pi√π ‚Äúpulito‚Äù)
        resetPan(index);
        setPanVars();

        fitToViewport(true);
      }

      // --- Smart fit
      function fitToViewport(forceFit){
        const active = slides[index];
        if(!active) return;

        const vw = stage.clientWidth;
        const vh = stage.clientHeight;

        const slideW = active.offsetWidth;
        const slideH = active.offsetHeight;

        const pad = 18;
        const s = Math.min((vw - pad) / slideW, (vh - pad) / slideH);

        baseFit = clamp(s, 0.35, 1.15);

        if(forceFit){
          scale = baseFit;
          document.documentElement.style.setProperty('--web-scale', scale.toFixed(3));
        }else{
          // se l'utente ha zoomato, non lo "rompiamo" ‚Äî ma garantiamo un minimo
          scale = clamp(scale, 0.35, 1.6);
          document.documentElement.style.setProperty('--web-scale', scale.toFixed(3));
        }

        clampPanToBounds();
        setPanVars();
      }

      function clampPanToBounds(){
        const active = slides[index];
        if(!active) return;

        // dimensioni stage e slide scalata
        const vw = stage.clientWidth;
        const vh = stage.clientHeight;

        const slideW = active.offsetWidth * scale;
        const slideH = active.offsetHeight * scale;

        // se la slide √® pi√π piccola dello stage -> pan zero
        const maxX = Math.max(0, (slideW - vw) / 2);
        const maxY = Math.max(0, (slideH - vh) / 2);

        const p = pans[index];
        p.x = clamp(p.x, -maxX, maxX);
        p.y = clamp(p.y, -maxY, maxY);
      }

      function next(){ show(index + 1); }
      function prev(){ show(index - 1); }

      // Buttons
      prevBtn?.addEventListener('click', prev);
      nextBtn?.addEventListener('click', next);

      zoomInBtn?.addEventListener('click', () => {
        scale = clamp(scale + 0.10, 0.35, 1.6);
        document.documentElement.style.setProperty('--web-scale', scale.toFixed(3));
        clampPanToBounds();
        setPanVars();
      });
      zoomOutBtn?.addEventListener('click', () => {
        scale = clamp(scale - 0.10, 0.35, 1.6);
        document.documentElement.style.setProperty('--web-scale', scale.toFixed(3));

        // se torni vicino al fit, reset pan (sensazione ‚Äúcentrata‚Äù)
        if(scale <= baseFit + 0.02){
          scale = baseFit;
          document.documentElement.style.setProperty('--web-scale', scale.toFixed(3));
          resetPan(index);
        }

        clampPanToBounds();
        setPanVars();
      });

      // Keyboard
      document.addEventListener('keydown', (e) => {
        const tag = (e.target && e.target.tagName) ? e.target.tagName.toLowerCase() : '';
        if(tag === 'input' || tag === 'textarea' || e.isComposing) return;

        if(e.key === 'ArrowRight' || e.key === 'PageDown' || e.key === ' '){ e.preventDefault(); next(); }
        if(e.key === 'ArrowLeft'  || e.key === 'PageUp'){ e.preventDefault(); prev(); }
        if(e.key.toLowerCase() === 'p'){ e.preventDefault(); pdfBtn?.click(); }
        if(e.key === '+'){ e.preventDefault(); zoomInBtn?.click(); }
        if(e.key === '-'){ e.preventDefault(); zoomOutBtn?.click(); }
      });

      // ---- PAN (drag) quando zoom > fit
      let isDragging = false;
      let dragStartX = 0, dragStartY = 0;
      let panStartX = 0, panStartY = 0;

      function canPan(){
        return scale > (baseFit + 0.03);
      }

      stage.addEventListener('pointerdown', (e) => {
        if(!canPan()) return;
        isDragging = true;
        stage.setPointerCapture?.(e.pointerId);

        dragStartX = e.clientX;
        dragStartY = e.clientY;

        const p = pans[index];
        panStartX = p.x;
        panStartY = p.y;

        // feedback cursore
        stage.style.cursor = 'grabbing';
      });

      stage.addEventListener('pointermove', (e) => {
        if(!isDragging) return;
        const dx = e.clientX - dragStartX;
        const dy = e.clientY - dragStartY;

        const p = pans[index];
        p.x = panStartX + dx;
        p.y = panStartY + dy;

        clampPanToBounds();
        setPanVars();
      });

      function endDrag(){
        isDragging = false;
        stage.style.cursor = '';
      }
      stage.addEventListener('pointerup', endDrag);
      stage.addEventListener('pointercancel', endDrag);
      stage.addEventListener('pointerleave', endDrag);

      // Swipe (mobile) SOLO se non stai pannando
      let startX = 0, startY = 0, isTouch = false;
      stage.addEventListener('touchstart', (e) => {
        if(canPan()) return; // se zoomato, lasciamo il drag/pan
        const t = e.touches[0];
        startX = t.clientX; startY = t.clientY;
        isTouch = true;
      }, {passive:true});

      stage.addEventListener('touchend', (e) => {
        if(!isTouch) return;
        isTouch = false;
        const t = e.changedTouches[0];
        const dx = t.clientX - startX;
        const dy = t.clientY - startY;
        if(Math.abs(dx) > 50 && Math.abs(dx) > Math.abs(dy)){
          dx < 0 ? next() : prev();
        }
      }, {passive:true});

      // Pinch zoom (mobile) - molto semplice
      let pinchDist0 = 0;
      stage.addEventListener('touchstart', (e) => {
        if(e.touches.length === 2){
          const a = e.touches[0], b = e.touches[1];
          pinchDist0 = Math.hypot(b.clientX - a.clientX, b.clientY - a.clientY);
        }
      }, {passive:true});

      stage.addEventListener('touchmove', (e) => {
        if(e.touches.length !== 2) return;
        const a = e.touches[0], b = e.touches[1];
        const d = Math.hypot(b.clientX - a.clientX, b.clientY - a.clientY);
        if(!pinchDist0) pinchDist0 = d;

        const ratio = d / pinchDist0;
        const nextScale = clamp(scale * ratio, 0.35, 1.6);

        // aggiorna
        scale = nextScale;
        document.documentElement.style.setProperty('--web-scale', scale.toFixed(3));
        clampPanToBounds();
        setPanVars();

        pinchDist0 = d;
      }, {passive:true});

      stage.addEventListener('touchend', (e) => {
        if(e.touches.length < 2) pinchDist0 = 0;
        // se torni vicino al fit, recentra
        if(scale <= baseFit + 0.02){
          scale = baseFit;
          document.documentElement.style.setProperty('--web-scale', scale.toFixed(3));
          resetPan(index);
          setPanVars();
        }
      }, {passive:true});

      // Resize
      window.addEventListener('resize', () => fitToViewport(false));

      // ===== PDF: genera e scarica (NON stampa) =====
      async function generatePdf(){
        const { jsPDF } = window.jspdf || {};
        if(!jsPDF || !window.html2canvas){
          // fallback: se qualche CDN non carica, fai la stampa.
          window.print();
          return;
        }

        pdfBtn.disabled = true;
        pdfOverlay?.classList.add('is-on');

        // salva stato viewer
        const prevIndex = index;
        const prevScale = scale;
        const prevFit = baseFit;

        // forza render pulito: scala 1 e pan 0
        scale = 1;
        document.documentElement.style.setProperty('--web-scale', '1');
        document.documentElement.style.setProperty('--pan-x', '0px');
        document.documentElement.style.setProperty('--pan-y', '0px');

        // prepara pdf in mm con dimensione identica alle slide
        const pdf = new jsPDF({
          orientation: 'landscape',
          unit: 'mm',
          format: [297, 167]
        });

        try{
          for(let i=0;i<slides.length;i++){
            // mostra slide i
            slides.forEach((el, k) => el.classList.toggle('is-active', k === i));

            // piccolo wait per layout
            await new Promise(r => setTimeout(r, 60));

            const slideEl = slides[i];

            // html2canvas
            const canvas = await html2canvas(slideEl, {
              scale: 2,               // qualit√†
              useCORS: true,          // immagini esterne
              backgroundColor: null,  // mantiene trasparenze/gradients
              logging: false
            });

            const imgData = canvas.toDataURL('image/jpeg', 0.92);

            if(i > 0) pdf.addPage([297,167], 'landscape');

            // riempi tutta pagina (297x167)
            pdf.addImage(imgData, 'JPEG', 0, 0, 297, 167, undefined, 'FAST');
          }

          const filename = 'Gestione-Strategica-eCommerce.pdf';
          pdf.save(filename);
        }catch(err){
          // fallback: stampa
          try{ window.print(); }catch(e){}
        }finally{
          // ripristina
          slides.forEach((el, k) => el.classList.toggle('is-active', k === prevIndex));
          index = prevIndex;

          // torna a fit
          baseFit = prevFit;
          fitToViewport(true);

          // ripristina scala utente (se aveva zoomato)
          scale = prevScale;
          document.documentElement.style.setProperty('--web-scale', scale.toFixed(3));
          resetPan(index);
          setPanVars();

          pdfOverlay?.classList.remove('is-on');
          pdfBtn.disabled = false;
        }
      }

      pdfBtn?.addEventListener('click', generatePdf);

      // init
      const initial = clamp(getParamS() - 1, 0, slides.length - 1);
      show(initial);
    })();
  </script>

</body>
</html>
